# Mandap Billing System - Project Context

This file serves as a comprehensive reference for the Mandap Billing System project, detailing the architecture, technology stack, and operational procedures.

## üöÄ Project Overview
A specialized billing and inventory rental management system designed for **Fagun Sud 13 Mandap Contractor**, featuring a modern UI and a robust Spring Boot backend.

> **Important**: This software manages rentals for a **single annual event** (Fagun Sud 13). Each customer has **one rental order** and **one bill** per event cycle.

---

## üõ†Ô∏è Technology Stack

### **Backend**
- **Core**: Java 17, Spring Boot 3.2.3
- **Security**: Spring Security, JWT (jjwt 0.12.5)
- **Database**: MySQL 8 (using Spring Data JPA)
- **Build Tool**: Maven
- **Utilities**: Lombok, Validation Starter

### **Frontend (mandap-ui)**
- **Framework**: Angular 21 (Latest)
- **Styling**: Tailwind CSS 4, DaisyUI 5
- **Icons**: FontAwesome 7
- **State/Logic**: RxJS, Reactive Forms, Signals
- **UI Components**: ng-select

---

## üìÇ Project Structure

### **Root Directory**
- `src/`: Java backend source code.
- `mandap-ui/`: Angular frontend application.
- `pom.xml`: Maven configuration.
- `SETUP.md`: Deployment and setup guide.
- `README.md`: General project overview.

### **Backend Details (`src/main/java/com/mandap/`)**
- `config/`: Security and data initialization.
- `controller/`: REST API endpoints.
- `dto/`: Data Transfer Objects for API requests/responses.
- `entity/`: JPA entities representing database tables.
- `repository/`: Data access layer (Spring Data JPA).
- `security/`: JWT filtering and authentication logic.
- `service/`: Business logic layer.

### **Frontend Details (`mandap-ui/src/app/`)**
- `core/`: Services, models, and guards used across the app.
- `features/`: Module-based feature components (Billing, Customers, Inventory, Rental Orders).
- `shared/`: Reusable components (Modal, Sidebar, Loading Spinner, Toasts).
- `layouts/`: Main layout structures.

---

## ‚öôÔ∏è Development & Operations

### **Starting the Servers**

#### **Backend**
```powershell
# From the root directory
mvn spring-boot:run
```
- **Port**: 8080 (Default)
- **Profiles**: Configured via `application.properties`.

#### **Frontend**
```powershell
# From the mandap-ui directory
npm install
npm start  # Runs 'ng serve'
```
- **Port**: 4200 (Default)
- **Proxy**: Configured in `proxy.conf.json` to route `/api` calls to the backend.

### **Deployment**

#### **Backend**
- Package into an executable JAR: `mvn clean package`.
- Run using: `java -jar target/mandap-billing-1.0.0.jar`.

#### **Frontend**
- Build for production: `npm run build`.
- Artifacts are generated in `mandap-ui/dist/`.
- Can be served via Nginx or integrated into the Spring Boot `static/` folder.

---

## ‚ú® Core Functionalities

### 1. **Authentication**
Secure login with JWT and role-based access control.

### 2. **Inventory Management**
- 60+ pre-defined rental items with bilingual names (English/Gujarati)
- Stock tracking: `totalStock` and `availableStock` per item
- Bilingual search (English and Gujarati)
- Automatic stock adjustment on dispatch/receive

### 3. **Rental Order Lifecycle**
- **One rental order per customer** (single event model)
- Status flow: `BOOKED ‚Üí DISPATCHED ‚Üí PARTIALLY_RETURNED ‚Üí RETURNED ‚Üí COMPLETED`
- **Partial dispatch/receive**: Items can be dispatched/returned in chunks over time
- Unreturned items tracking for billing integration

### 4. **Billing**
- **One bill per customer** (single event model)
- Generate bill from existing rental order (pre-populated data)
- Two-column Gujarati print format
- Support for deposits and partial payments

### 5. **Customer Management**
Full CRUD for customers with rental history tracking.

### 6. **Theme Management**
Support for Dark/Light mode with persistent preference.

---

## üîë Business Rules

| Rule | Description |
|------|-------------|
| One Order Per Customer | Each customer can have only one rental order in the system |
| One Bill Per Customer | Each customer can have only one bill |
| No Events Concept | The software serves a single annual event; Events feature is removed |
| Partial Operations | Items can be dispatched and returned in multiple chunks |
| Stock Validation | Cannot book/dispatch more items than available stock |

---

## üìù Ongoing Context & Rules
- **Formatting**: Maintain Prettier/PostCSS standards in the UI.
- **API Styling**: Follow RESTful principles for backend controllers.
- **UI Design**: Prioritize glassmorphism and modern aesthetics as defined in the initial development phase.
- **Single Event Model**: All features operate under the assumption of one event cycle.
