<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <title>Fagun Sud 13 - Mandap Billing System</title>
    <link rel="stylesheet"
          href="/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Input Tools for Gujarati -->
    <script src="https://www.google.com/jsapi"></script>
</head>

<body>
    <div id="app">
        <!-- Login Page -->
        <div id="login-page"
             class="page active">
            <div class="login-container">
                <div class="login-card glass-card">
                    <div class="login-header">
                        <div class="logo-icon">
                            <i class="fas fa-campground"></i>
                        </div>
                        <h1>ફાગણ સુદ ૧૩</h1>
                        <p class="subtitle">Mandap Billing System</p>
                    </div>
                    <form id="login-form">
                        <div class="form-group">
                            <label for="username"><i class="fas fa-user"></i> Username</label>
                            <input type="text"
                                   id="username"
                                   name="username"
                                   required
                                   placeholder="Enter username">
                        </div>
                        <div class="form-group">
                            <label for="password"><i class="fas fa-lock"></i> Password</label>
                            <input type="password"
                                   id="password"
                                   name="password"
                                   required
                                   placeholder="Enter password">
                        </div>
                        <button type="submit"
                                class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <p id="login-error"
                           class="error-message"></p>
                    </form>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="main-app"
             class="page">
            <!-- Sidebar -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <div class="logo">
                        <i class="fas fa-campground"></i>
                        <span>Mandap Billing</span>
                    </div>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item active"
                        data-page="dashboard">
                        <a href="#"><i class="fas fa-home"></i> Dashboard</a>
                    </li>
                    <li class="nav-item"
                        data-page="customers">
                        <a href="#"><i class="fas fa-users"></i> Customers</a>
                    </li>
                    <li class="nav-item"
                        data-page="events">
                        <a href="#"><i class="fas fa-calendar-alt"></i> Events</a>
                    </li>
                    <li class="nav-item"
                        data-page="billing">
                        <a href="#"><i class="fas fa-file-invoice-dollar"></i> New Bill</a>
                    </li>
                    <li class="nav-item"
                        data-page="bills">
                        <a href="#"><i class="fas fa-history"></i> Bill History</a>
                    </li>
                    <li class="nav-item"
                        data-page="inventory">
                        <a href="#"><i class="fas fa-boxes"></i> Inventory</a>
                    </li>
                    <li class="nav-item admin-only"
                        data-page="users">
                        <a href="#"><i class="fas fa-user-cog"></i> Users</a>
                    </li>
                    <li class="nav-item admin-only"
                        data-page="roles">
                        <a href="#"><i class="fas fa-shield-alt"></i> Roles</a>
                    </li>
                </ul>
                <div class="sidebar-footer">
                    <div class="user-info">
                        <i class="fas fa-user-circle"></i>
                        <span id="current-user">Admin</span>
                    </div>
                    <button id="logout-btn"
                            class="btn btn-danger btn-sm">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </nav>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Dashboard Page -->
                <div id="dashboard-page"
                     class="content-page active">
                    <div class="page-header">
                        <h2><i class="fas fa-home"></i> Dashboard</h2>
                        <p>Welcome to Fagun Sud 13 Mandap Billing System</p>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card glass-card">
                            <div class="stat-icon"
                                 style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-customers">0</h3>
                                <p>Total Customers</p>
                            </div>
                        </div>
                        <div class="stat-card glass-card">
                            <div class="stat-icon"
                                 style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-events">0</h3>
                                <p>Active Events</p>
                            </div>
                        </div>
                        <div class="stat-card glass-card">
                            <div class="stat-icon"
                                 style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                                <i class="fas fa-file-invoice"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-bills">0</h3>
                                <p>Bills This Year</p>
                            </div>
                        </div>
                        <div class="stat-card glass-card">
                            <div class="stat-icon"
                                 style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                <i class="fas fa-rupee-sign"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="stat-revenue">₹0</h3>
                                <p>Total Revenue</p>
                            </div>
                        </div>
                    </div>
                    <div class="dashboard-grid">
                        <div class="recent-bills glass-card">
                            <h3><i class="fas fa-clock"></i> Recent Bills</h3>
                            <div id="recent-bills-list"
                                 class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Bill No</th>
                                            <th>Customer</th>
                                            <th>Event</th>
                                            <th>Amount</th>
                                            <th>Date</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recent-bills-body">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customers Page -->
                <div id="customers-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-users"></i> Customers</h2>
                        <button class="btn btn-primary"
                                onclick="showCustomerModal()">
                            <i class="fas fa-plus"></i> Add Customer
                        </button>
                    </div>
                    <div class="search-bar">
                        <input type="text"
                               id="customer-search"
                               placeholder="Search by name or mobile..."
                               oninput="searchCustomers()">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="table-responsive glass-card">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Mobile</th>
                                    <th>Address</th>
                                    <th>Alt. Contact</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customers-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Events Page -->
                <div id="events-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-calendar-alt"></i> Events</h2>
                        <button class="btn btn-primary"
                                onclick="showEventModal()">
                            <i class="fas fa-plus"></i> Create Event
                        </button>
                    </div>
                    <div class="table-responsive glass-card">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Event Name</th>
                                    <th>Type</th>
                                    <th>Year</th>
                                    <th>Date</th>
                                    <th>Total Pals</th>
                                    <th>Bills</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="events-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Billing Page -->
                <div id="billing-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-file-invoice-dollar"></i> Create New Bill</h2>
                    </div>
                    <div class="billing-form glass-card">
                        <div class="billing-header">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Event *</label>
                                    <select id="bill-event"
                                            onchange="onEventChange()"
                                            required>
                                        <option value="">Select Event</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Customer *</label>
                                    <select id="bill-customer"
                                            required>
                                        <option value="">Select Customer</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Bill Date *</label>
                                    <input type="date"
                                           id="bill-date"
                                           required>
                                </div>
                                <div class="form-group">
                                    <label>Pal Count</label>
                                    <input type="number"
                                           id="bill-pal-count"
                                           value="1"
                                           min="1">
                                </div>
                            </div>
                        </div>

                        <div class="billing-items">
                            <div class="items-container">
                                <div class="items-column">
                                    <h4>Left Side Items</h4>
                                    <div id="left-items"
                                         class="items-list">
                                    </div>
                                </div>
                                <div class="items-column">
                                    <h4>Right Side Items</h4>
                                    <div id="right-items"
                                         class="items-list">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="billing-footer">
                            <div class="totals-section">
                                <div class="total-row">
                                    <span>Total Amount:</span>
                                    <span id="bill-total">₹ 0</span>
                                </div>
                                <div class="total-row">
                                    <label>Deposit:</label>
                                    <input type="number"
                                           id="bill-deposit"
                                           value="0"
                                           min="0"
                                           oninput="calculateTotals()">
                                </div>
                                <div class="total-row net-payable">
                                    <span>Net Payable:</span>
                                    <span id="bill-net">₹ 0</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Remarks</label>
                                <textarea id="bill-remarks"
                                          rows="2"
                                          placeholder="Any additional notes..."></textarea>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-secondary"
                                        onclick="resetBillForm()">
                                    <i class="fas fa-redo"></i> Reset
                                </button>
                                <button class="btn btn-primary"
                                        onclick="saveBill()">
                                    <i class="fas fa-save"></i> Save Bill
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bills History Page -->
                <div id="bills-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-history"></i> Bill History</h2>
                    </div>
                    <div class="filter-bar">
                        <div class="form-group">
                            <label>Year</label>
                            <select id="filter-year"
                                    onchange="loadBills()">
                                <option value="">All Years</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Event</label>
                            <select id="filter-event"
                                    onchange="loadBills()">
                                <option value="">All Events</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Search</label>
                            <input type="text"
                                   id="bill-search"
                                   placeholder="Search by customer or bill no..."
                                   oninput="searchBills()">
                        </div>
                    </div>
                    <div class="table-responsive glass-card">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bill No</th>
                                    <th>Customer</th>
                                    <th>Mobile</th>
                                    <th>Event</th>
                                    <th>Pals</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Total</th>
                                    <th>Deposit</th>
                                    <th>Net</th>
                                    <th>Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="bills-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Inventory Page -->
                <div id="inventory-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-boxes"></i> Inventory Items</h2>
                    </div>
                    <div class="inventory-grid">
                        <div class="glass-card">
                            <h3>Left Side Items</h3>
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Item (Gujarati)</th>
                                            <th>Item (English)</th>
                                            <th>Rate (₹)</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="inventory-left-body">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="glass-card">
                            <h3>Right Side Items</h3>
                            <div class="table-responsive">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>Item (Gujarati)</th>
                                            <th>Item (English)</th>
                                            <th>Rate (₹)</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="inventory-right-body">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users Page (Admin) -->
                <div id="users-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-user-cog"></i> User Management</h2>
                        <button class="btn btn-primary"
                                onclick="showUserModal()">
                            <i class="fas fa-plus"></i> Add User
                        </button>
                    </div>
                    <div class="table-responsive glass-card">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Full Name</th>
                                    <th>Email</th>
                                    <th>Roles</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Roles Page (Admin) -->
                <div id="roles-page"
                     class="content-page">
                    <div class="page-header">
                        <h2><i class="fas fa-shield-alt"></i> Role Management</h2>
                        <button class="btn btn-primary"
                                onclick="showRoleModal()">
                            <i class="fas fa-plus"></i> Add Role
                        </button>
                    </div>
                    <div class="roles-grid">
                        <div class="table-responsive glass-card">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Role Name</th>
                                        <th>Description</th>
                                        <th>Permissions</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="roles-table-body">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <div id="modal-overlay"
         class="modal-overlay">
        <div id="modal-container"
             class="modal-container glass-card">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <button class="modal-close"
                        onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-content"
                 class="modal-content">
            </div>
        </div>
    </div>

    <!-- Print Template -->
    <div id="print-container"
         class="print-only">
    </div>

    <!-- Toast Notification -->
    <div id="toast"
         class="toast"></div>

    <script src="/js/api.js"></script>
    <script src="/js/app.js"></script>
</body>

</html>